<div class="container-fluid">

    <div class="row module-header">
        <div class="col-xs-12">
            <div class="module-name">Utilization Report</div>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12">
            <div class="report-row">
                <div class="row header-row">
                    <h6>Configuration</h6>
                </div>
                <div *ngIf="!showAssigneesAndResources">
                    <button md-button class="show-data" (click)="showProjectsInfo()">
                        <h5 class="pull-left">
                            <span class="glyphicon {{showProjects ? 'glyphicon-menu-down' : 'glyphicon-menu-right'}}"
                                  aria-hidden="true"></span>
                            Projects
                        </h5>
                    </button>
                    <div *ngIf="showProjects">
                        <div class="row">
                            <div class="col-md-2">
                                <md-input-container>
                                    <input mdInput placeholder="Type project name..."
                                           (keyup)="filterProjects($event.target.value)">
                                </md-input-container>
                            </div>
                            <div class="col-md-1">
                                <button md-button (click)="showAllProjects()">SHOW ALL</button>
                            </div>
                        </div>

                        <div *ngIf="filteredProjectRows && filteredProjectRows.length">
                            <div class="col-xs-12" *ngFor="let projectRow of filteredProjectRows">
                                <md-checkbox [(ngModel)]="model.projects[projectRow.id]" (change)="getProjectCount()"
                                             name="{{projectRow.id}}">
                                    {{projectRow.name}}
                                </md-checkbox>
                            </div>
                        </div>

                        <div class="row select-buttons">
                            <button md-button (click)="showSelectedProjects()">SHOW SELECTED({{projectCount}})</button>
                            <button class="btn btn-success pull-right" (click)="chooseProjects()" type="submit">NEXT
                            </button>
                        </div>
                    </div>
                </div>
                <div *ngIf="showAssigneesAndResources">
                    <table class="table borderless">
                        <tr>
                            <td class="col-md-1">
                                <p style="font-size: 18px">
                                    <a class="edit-button" (click)="backToProjects()">
                                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                    </a>
                                    Projects:
                                </p>
                            </td>
                            <td class="col-md-11">
                                <p style="font-size: 18px">
                                <span *ngFor="let projectRow of filteredProjectRows">
                                    {{projectRow.name}}<span
                                        *ngIf="filteredProjectRows.length > 1 && filteredProjectRows.length - 1 !== filteredProjectRows.indexOf(projectRow)">, </span>
                                </span>
                                </p>
                            </td>
                        </tr>
                    </table>

                    <div *ngIf="!showGroupBy">
                        <button md-button class="show-data" (click)="showPeopleInfo()" style="margin-top: 0px">
                            <h5 class="pull-left">
                                <span class="glyphicon {{showPeople ? 'glyphicon-menu-down' : 'glyphicon-menu-right'}}"
                                      aria-hidden="true"></span>
                                People {{(showPeople || peopleCount === 0)? ' ' : '(' + peopleCount + ' selected)'}}
                            </h5>
                        </button>
                        <div *ngIf="showPeople">
                            <div class="row">
                                <div class="col-md-2">
                                    <md-input-container>
                                        <input mdInput placeholder="Type person name..."
                                               (keyup)="filterPeople($event.target.value)">
                                    </md-input-container>
                                </div>
                                <div class="col-md-1">
                                    <button md-button (click)="showAllPeople()">SHOW ALL</button>
                                </div>
                            </div>

                            <div *ngIf="filteredPeopleRows && filteredPeopleRows.length">
                                <div class="col-xs-12" *ngFor="let peopleRow of filteredPeopleRows">
                                    <md-checkbox [(ngModel)]="model.assignees[peopleRow.email]"
                                                 (change)="getPeopleCount()" name="{{peopleRow.email}}">
                                        {{peopleRow.first_name + ' ' + peopleRow.last_name}}
                                    </md-checkbox>
                                </div>
                            </div>

                            <div class="row select-buttons">
                                <button md-button (click)="showSelectedPeople()">SHOW SELECTED({{peopleCount}})</button>
                            </div>
                        </div>
                        <br/>
                    </div>
                    <div *ngIf="showGroupBy">
                        <table class="table borderless">
                            <tr>
                                <td class="col-md-1">
                                    <p style="font-size: 18px">
                                        <a class="edit-button" (click)="backToPeople()">
                                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                        </a>
                                        People:
                                    </p>
                                </td>
                                <td class="col-md-11">
                                    <p style="font-size: 18px">
                                <span *ngFor="let peopleRow of filteredPeopleRows">
                                    {{peopleRow.first_name + ' ' + peopleRow.last_name}}<span
                                        *ngIf="filteredPeopleRows.length > 1 && filteredPeopleRows.length - 1 !== filteredPeopleRows.indexOf(peopleRow)">, </span>
                                </span>
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <div *ngIf="!showGroupBy">
                        <button md-button class="show-data" (click)="showResourcesInfo()" style="margin-top: 0px">
                            <h5 class="pull-left">
                                <span class="glyphicon {{showResources ? 'glyphicon-menu-down' : 'glyphicon-menu-right'}}"
                                      aria-hidden="true"></span>
                                Resources {{(showResources || resourceCount === 0)? ' ' : '(' + resourceCount + '
                                selected)'}}
                            </h5>
                        </button>
                        <div *ngIf="showResources">
                            <div class="row">
                                <div class="col-md-2">
                                    <md-input-container>
                                        <input mdInput placeholder="Type resource name..."
                                               (keyup)="filterResources($event.target.value)">
                                    </md-input-container>
                                </div>
                                <div class="col-md-1">
                                    <button md-button (click)="showAllResources()">SHOW ALL</button>
                                </div>
                            </div>

                            <div *ngIf="filteredResourceRows && filteredResourceRows.length">
                                <div class="col-xs-12" *ngFor="let resourceRow of filteredResourceRows">
                                    <md-checkbox [(ngModel)]="model.resources[resourceRow.name]"
                                                 (change)="getResourceCount()" name="{{resourceRow.name}}">
                                        {{resourceRow.name}}
                                    </md-checkbox>
                                </div>
                            </div>

                            <div class="row select-buttons">
                                <button md-button (click)="showSelectedResources()">SHOW SELECTED({{resourceCount}})
                                </button>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="showGroupBy">
                        <table class="table borderless">
                            <tr>
                                <td class="col-md-1">
                                    <p style="font-size: 18px">
                                        <a class="edit-button" (click)="backToResources()">
                                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                        </a>
                                        Resources:
                                    </p>
                                </td>
                                <td class="col-md-11">
                                    <p style="font-size: 18px">
                                <span *ngFor="let resourceRow of filteredResourceRows">
                                    {{resourceRow.name}}<span
                                        *ngIf="filteredResourceRows.length > 1 && filteredResourceRows.length - 1 !== filteredResourceRows.indexOf(resourceRow)">, </span>
                                </span>
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <br/>

                    <button *ngIf="!showGroupBy" class="btn btn-success pull-right" (click)="showGroupBySection()" type="submit">NEXT
                    </button>

                    <div *ngIf="showGroupBy">
                        <button md-button class="show-data" (click)="showGroupByInfo()" style="margin-top: 0px">
                            <h5 class="pull-left">
                                <span class="glyphicon {{showGroupByData ? 'glyphicon-menu-down' : 'glyphicon-menu-right'}}"
                                      aria-hidden="true"></span>
                                Group by
                            </h5>
                        </button>
                        <div *ngIf="showGroupByData">
                            <div class="row">
                                <div class="groupings">
                                    <md-select [(ngModel)]="model.group_by" name="group_by">
                                        <md-option *ngFor="let grouping of groupings" [value]="grouping">
                                            {{grouping}}
                                        </md-option>
                                    </md-select>
                                </div>
                            </div>

                            <button class="btn btn-success pull-right" (click)="save()" type="submit">SUBMIT
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


